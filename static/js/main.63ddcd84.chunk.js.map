{"version":3,"sources":["helpers/utils.js","model/ForecastModel.js","model/InvestmentModel.js","renderer/D3ChartStrategy.js","renderer/LineChartD3.js","renderer/CashflowBarChartD3.js","components/Visualization.jsx","components/MinimalBootstrapComponents.jsx","components/TextInputElement.jsx","components/CheckboxInputElement.jsx","components/BrokerDropDown.jsx","components/GraphDetailDropDown.jsx","components/ETFSelectionDropDown.jsx","components/App.jsx","reportWebVitals.js","index.js"],"names":["timeDiffIgnoreDivisor","numberOfMonthsOfAYear","isFirstMonthOfAYear","date","getMonth","loadHistoricalETFData","etfIdentifier","apiKey","a","d3","entry","Date","timestamp","toString","dividend","parseFloat","course","historicalData","sort","b","etfHistoricalToCourseForecastArray","map","dateToTimestamp","etfHistoricalToDividendForecastArray","currentYear","getFullYear","dividendForecastArray","forEach","length","push","Math","floor","getTime","HistoricalDataNotPresentException","this","message","name","roundDateToBeginningOfMonth","month","year","currentDayOfMonth","getDate","maxDayOfMonth","monthOffset","round","ForecastModelSingleton","coursePredictors","dividendPredictors","courseForecastArray","maxTimestampBeforeCoursePredictorRepetition","_calculateMaxTimestampBeforePredictorRepetition","maxYearBeforeDividendPredictorRepetition","history","forecastArray","lastTimestampToIncludeInPrediction","abs","backCastTimeFactor","backCastTimestampConstant","filteredForecastArray","filter","regression","linear","order","precision","lastYearToIncludeInPrediction","_courseDateToPredictorTimestampAndDateTimestamp","predictorTimestamp","_createCoursePredictorIfNotPresent","predict","predictorYear","_dividendYearToPredictorYear","_createDividendPredictorIfNotPresent","max","backCastTimeConstant","backCastTimeDate","setMonth","instance","getInstance","etfProperties","configure","forecast","loadAndCacheHistoricalETFData","symbol","console","log","firstTimestamp","lastTimestamp","corporateTaxRatio","getNextMonthDate","newDate","calculateDividend","isLastMonthOfAYear","dividendAmount","predictDividend","sharePrize","predictCourse","calculateCosts","amount","costConfiguration","costs","percentageCosts","fixedCosts","amountWithoutCosts","subtractTaxFreeGain","taxAmount","taxFreeAmount","getTotalShareValue","investmentStep","totalShares","sharePrizes","getTotalDividenShareValue","dividendTotalShares","getNewShareValue","newShares","calculateAndAddInflation","initialDate","endDate","sumTotalValues","sum","sumOfTotalValues","timeFactor","inflation","pow","addAccumulationMonth","investmentSteps","investment","etfToRatio","configOptions","prevInvestmentStep","newInvestmentStep","dividendNewShares","totalCosts","totalInvestedMoney","newInvestedMoney","newInvestment","totalTaxes","totalPayout","newPayout","investmentOfEtfWithCosts","costConfig","investmentOfEtfWithoutCosts","etfSharePrize","dividendPayoutMoneyPerShare","newSharesByDividend","leftoverTaxFreeAmount","value","min","summedTaxes","decemberInvestmentStep","firstInvestmentStepOfThisYear","accumulatedBasicProfit","i","profitOverAllTime","profitOfPreviousYears","amountToApplyTaxes","calculateTaxes","newTaxes","newLeftoverTaxFreeAmount","addPayoutMonth","sellingAmount","leftoverAlreadyPaidTaxes","payoutStats","taxes","investmentStepsIdx","amountToSell","amountAlreadySold","costsToPay","alreadyPaidCosts","payoutInvestmentStepIdxForFIFO","currentSharesLeft","alreadySoldShares","leftoverAmountToSell","currentInvestmentStepForFIFO","currentValueOfShares","amountToSellWithCosts","amountOfSharesToSell","amountToSellWithoutCosts","initialValueOfShares","amountToPayTaxes","taxesToPay","payoutAmount","amountOfDividendSharesLeft","amountOfDividendSharesSold","generateEmptyInvestmentStep","emptyInvestmentStep","InvestmentModel","startCapital","monthlyInvestment","monthlyPayout","savingPhaseLength","age","expectationOfLife","_calculateTimestampsForModel","_calculateModel","lifeExpectation","fadeOutYears","yearsLeft","now","beginningDate","endSavingPhaseDate","setFullYear","calculateForecastInterval","startDate","savingDates","currentDate","payoutDates","slice","savingDate","payoutDate","numberOfEntriesPerYear","Number","isInteger","Error","selectedInvestmentSteps","numberOfMonthsToMerge","adjustedInvestmentStep","cloneDeep","offset","FIVE_MILLION","ONE_MILLION","setInteractionDisplayForActiveDiagrams","displayOption","D3ChartStrategy","activeStrategies","interaction","style","renderDivRef","payoutPhaseStartDate","svgID","width","height","marginW","marginH","constructor","lineStrokeWidth","labelValueIdentifier","innerHTML","svg","append","attr","_prepareData","_calculateExtents","_createScales","_drawContent","_prepareText","_drawText","_drawAxis","_addInteraction","dateExtent","dataArray","d","lastImportantDateForYScale","filteredDataArrayForYMax","maxIndex","e","filteredDataArrayForYMin","minIndex","maxVal","yStart","minVal","yEnd","yExtent","yScale","domain","range","xScale","hasToBePositive","labelDivisionFactor","numberIndicator","toLocaleString","undefined","maximumFractionDigits","call","tickFormat","valueToDisplayText","ticks","hoverLine","on","mouseEvent","_handleTooltipEvent","x","roundedDate","invert","investmentStepIndex","firstDate","secondDate","numberOfMonthsSinceStartDate","numberOfMonthsPerInvestmentStep","calculateInvestmentStepIndexForDate","activeDiagram","_updateTooltip","_updateText","textGroup","selectAll","data","Object","values","textProperties","enter","text","y","fontSize","fontWeight","textAnchor","color","savingPhaseMid","payoutPhaseMid","yPos","standardFontSize","saving","savingPhase","payout","payoutPhase","generateEtfValueText","investmentValue","totalValue","generateNegativeLabelText","charAt","toUpperCase","negativeLabels","negativeLabelsToInvestmentStepIdentifier","capitalIdentifier","investedIdentifier","LineChartD3","etfLineColors","total","invested","ESGE","SUSA","colors","lineOpacity","etfIdentifiers","keys","dataToIndex","currentIdx","heightOffset","totalShareValue","totalDividendShareValue","datum","_drawArea","curve","y0","y1","paddingW","paddingH","ETF_SYMBOL_TO_NAME","investedValue","updatedValueText","negativeLabel","CashflowBarChart","barPaddingPercentage","zeroLineStrokeWidth","sumNewPayout","rectWidth","needToSkipLastBar","barArray","Visualization","props","firstSVGRef","React","createRef","secondSVGRef","state","etfIdentifierToRatio","selected","percentage","STARTING_CAPITAL_IDENTIFIER","MONTHLY_INVESTMENT_IDENTIFIER","MONTHLY_PAYOUT_IDENTIFIER","SAVING_PHASE_IDENTIFIER","TAX_FREE_AMOUNT_IDENTIFIER","TRANSACTION_COSTS_TYPE_IDENTIFIER","TRANSACTION_COSTS_IDENTIFIER","AGE_IDENTIFIER","LIFE_EXPECTATION_IDENTIFIER","reset","isValid","investmentModel","getInvestmentModel","firstPayoutPhaseDate","correctLevelOfDetailInvestmentSteps","getInvestmentSteps","DETAILED_GRAPH_DROPDOWN_IDENTIFIER","current","render","error","drawVisualization","Fragment","ref","Component","SidebarSectionHeading","className","title","ErrorMessage","identifier","Overlay","visibility","displayOverlay","href","target","rel","TextInputElement","disabled","type","onClick","handleAPIKeyConfirm","id","errorMessage","htmlFor","label","textAppending","onChange","onValueChange","transformFunction","CheckboxInputElement","costsOfElementMatchUIValues","element","BrokerDropDown","data-bs-toggle","aria-expanded","aria-labelledby","elements","handleChange","GraphDetailDropDown","percentageTransformFunction","floatVal","isNaN","ETFSelectionDropDown","elementIdentifier","handleSelectionChange","handleShareChange","autoPercentage","ETF_DROPDOWN_SELECTION_IDENTIFIER","API_KEY_IDENTIFIER","BROKER_DROPDOWN_IDENTIFIER","ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER","transformInputToInt","intVal","parseInt","split","transformInputToFloat","isPositiveInt","val","recalculateETFPercentages","numberOfSelectedETFs","newPercentage","App","handleTextChange","bind","handleCheckBoxChange","handleBrokerChange","handleGraphDetailChange","handleETFSelectionChange","handleETFShareChange","caller","S_and_P_500","iShare","msciUSA","getInitialInputFormState","changedValue","changedStateIdentifier","validateAndSetState","brokerProperties","detailProperties","changedETFIdentifier","apiValues","loadHistoricData","setState","forceUpdate","positiveIntIdentifier","leftoverYears","sumOfPercentages","foundOneSelectedEtf","visualizationProps","assign","constructVisualizationProps","noValidate","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.63ddcd84.chunk.js","sourcesContent":["import * as d3 from 'd3';\n\n// Ignore milliseconds, seconds, minutes.\nconst timeDiffIgnoreDivisor = 1000 * 60 * 60 * 24;\n\nexport const timestampIndexOfForecastArray = 0;\nexport const courseIndexOfForecastArray = 1;\nexport const numberOfMonthsOfAYear = 12;\nexport const inflationRate = 0.01;\n\nexport function isLastMonthOfAYear(date) {\n    return date.getMonth() === numberOfMonthsOfAYear - 1;\n}\n\nexport function clamp(value, min, max) {\n    return Math.max(min, Math.min(value, max));\n}\n\nexport function isFirstMonthOfAYear(date) {\n    return date.getMonth() === 0;\n}\n\nexport async function loadHistoricalETFData(etfIdentifier, apiKey) {\n    const historicalData = await d3.csv(\n        `https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY_ADJUSTED&symbol=${etfIdentifier}&apikey=${apiKey}&datatype=csv`,\n        entry => {\n            return {\n                date: new Date(entry.timestamp.toString()),\n                dividend: parseFloat(entry['dividend amount']),\n                course: parseFloat(entry['adjusted close']),\n            };\n        }\n    );\n    historicalData.sort((a, b) => a.date - b.date);\n    return historicalData;\n}\n\nexport function etfHistoricalToCourseForecastArray(historicalData) {\n    return historicalData.map(entry => [dateToTimestamp(entry.date), entry.course]);\n}\n\n// Requires sorted historical data. Note it is sorted by default. Do not change the order.\nexport function etfHistoricalToDividendForecastArray(historicalData) {\n    let currentYear = historicalData[0].date.getFullYear();\n    const dividendForecastArray = [[currentYear, 0]];\n    historicalData.forEach(entry => {\n        if (entry.date.getFullYear() === currentYear) {\n            dividendForecastArray[dividendForecastArray.length - 1][courseIndexOfForecastArray] += entry.dividend;\n        } else {\n            currentYear = entry.date.getFullYear();\n            dividendForecastArray.push([currentYear, entry.dividend]);\n        }\n    });\n    dividendForecastArray.sort((a, b) => a[timestampIndexOfForecastArray] - b[timestampIndexOfForecastArray]);\n    return dividendForecastArray;\n}\n\nexport function dateToTimestamp(date) {\n    return Math.floor(date.getTime() / timeDiffIgnoreDivisor);\n}\n\nexport function timestampToDate(timestamp) {\n    return new Date(timestamp * timeDiffIgnoreDivisor);\n}\n\nexport function HistoricalDataNotPresentException(etfIdentifier) {\n    this.message = `First call loadHistoricalDataIfNotPresent() before predicting: ${etfIdentifier}`;\n    this.name = 'HistoricalDataNotPresentException';\n}\n\n// Slightly manipulated. Original: https://stackoverflow.com/a/315767\nfunction daysInMonth(month, year) {\n    return new Date(year, month + 1, 0).getDate();\n}\n\nexport function roundDateToBeginningOfMonth(date) {\n    const currentDayOfMonth = date.getDate();\n    const maxDayOfMonth = daysInMonth(date.getMonth(), date.getFullYear());\n    const monthOffset = Math.round(currentDayOfMonth / maxDayOfMonth);\n    return new Date(date.getFullYear(), date.getMonth() + monthOffset);\n}\n","import regression from 'regression';\nimport {\n    dateToTimestamp,\n    etfHistoricalToCourseForecastArray,\n    etfHistoricalToDividendForecastArray,\n    loadHistoricalETFData,\n    timestampIndexOfForecastArray,\n    courseIndexOfForecastArray,\n    HistoricalDataNotPresentException,\n} from '../helpers/utils';\n\n// USAGE: first call configure to set required static vars. Then the singleton can be accessed via getInstance. Never call the Constructor on your own.\n// Always call loadAndCacheHistoricalETFData of an etf before calling predict on that etf.\nexport class ForecastModelSingleton {\n    static instance = null;\n    static apiKey = null;\n    static backCastTimeConstant = null;\n    static backCastTimeFactor = null;\n\n    // DO NOT CALL. USE getInstance()\n    constructor() {\n        this.historicalData = {};\n        this.coursePredictors = {};\n        this.dividendPredictors = {};\n    }\n\n    static configure(apiKey, backCastTimeFactor = 2, backCastTimeConstant = 7) {\n        ForecastModelSingleton.apiKey = apiKey;\n        ForecastModelSingleton.backCastTimeFactor = backCastTimeFactor;\n\n        const backCastTimeDate = new Date(0);\n        backCastTimeDate.setMonth(backCastTimeConstant);\n        ForecastModelSingleton.backCastTimestampConstant = dateToTimestamp(backCastTimeDate);\n\n        // reset predictors if present.\n        if (ForecastModelSingleton.instance != null) {\n            const instance = ForecastModelSingleton.getInstance();\n            for (const etfIdentifier in instance.coursePredictors) {\n                instance.coursePredictors[etfIdentifier] = {\n                    maxTimestampBeforeCoursePredictorRepetition: ForecastModelSingleton._calculateMaxTimestampBeforePredictorRepetition(\n                        instance.historicalData[etfIdentifier].courseForecastArray\n                    ),\n                };\n            }\n            for (const etfIdentifier in instance.dividendPredictors) {\n                instance.dividendPredictors[etfIdentifier] = {\n                    maxYearBeforeDividendPredictorRepetition: ForecastModelSingleton._calculateMaxTimestampBeforePredictorRepetition(\n                        instance.historicalData[etfIdentifier].dividendForecastArray\n                    ),\n                };\n            }\n        }\n    }\n\n    static async loadHistoricData(apiKey, etfProperties) {\n        ForecastModelSingleton.configure(apiKey);\n        const forecast = ForecastModelSingleton.getInstance();\n        for (const etfIdentifier in etfProperties) {\n            await forecast.loadAndCacheHistoricalETFData(etfProperties[etfIdentifier].symbol);\n        }\n        console.log('Finished loading the historic data.');\n    }\n\n    static getInstance() {\n        if (ForecastModelSingleton.instance == null) {\n            ForecastModelSingleton.instance = new ForecastModelSingleton();\n        }\n        return ForecastModelSingleton.instance;\n    }\n\n    static _calculateMaxTimestampBeforePredictorRepetition(forecastArray) {\n        const firstTimestamp = forecastArray[0][timestampIndexOfForecastArray];\n        const lastTimestamp = forecastArray[forecastArray.length - 1][timestampIndexOfForecastArray];\n        return lastTimestamp + (lastTimestamp - firstTimestamp) / ForecastModelSingleton.backCastTimeFactor;\n    }\n\n    async loadAndCacheHistoricalETFData(etfIdentifier) {\n        if (etfIdentifier in this.historicalData) {\n            return;\n        }\n        const historicalData = await loadHistoricalETFData(etfIdentifier);\n\n        const courseForecastArray = etfHistoricalToCourseForecastArray(historicalData);\n        const maxTimestampBeforeCoursePredictorRepetition = ForecastModelSingleton._calculateMaxTimestampBeforePredictorRepetition(\n            courseForecastArray\n        );\n\n        const dividendForecastArray = etfHistoricalToDividendForecastArray(historicalData);\n        const maxYearBeforeDividendPredictorRepetition = ForecastModelSingleton._calculateMaxTimestampBeforePredictorRepetition(\n            dividendForecastArray\n        );\n\n        this.historicalData[etfIdentifier] = {\n            history: historicalData,\n            courseForecastArray: courseForecastArray,\n            dividendForecastArray: dividendForecastArray,\n        };\n        this.coursePredictors[etfIdentifier] = {\n            maxTimestampBeforeCoursePredictorRepetition: maxTimestampBeforeCoursePredictorRepetition,\n        };\n        this.dividendPredictors[etfIdentifier] = {\n            maxYearBeforeDividendPredictorRepetition: maxYearBeforeDividendPredictorRepetition,\n        };\n    }\n\n    _createCoursePredictorIfNotPresent(etfIdentifier, timestamp) {\n        // Skip if already exists.\n        if (timestamp in this.coursePredictors[etfIdentifier]) {\n            return;\n        }\n        const forecastArray = this.historicalData[etfIdentifier].courseForecastArray;\n        const lastTimestampToIncludeInPrediction =\n            forecastArray[forecastArray.length - 1][timestampIndexOfForecastArray] -\n            Math.abs(forecastArray[forecastArray.length - 1][timestampIndexOfForecastArray] - timestamp) *\n                ForecastModelSingleton.backCastTimeFactor -\n            ForecastModelSingleton.backCastTimestampConstant;\n        const filteredForecastArray = forecastArray.filter(\n            entry => entry[timestampIndexOfForecastArray] >= lastTimestampToIncludeInPrediction\n        );\n        this.coursePredictors[etfIdentifier][timestamp] = regression.linear(filteredForecastArray, {\n            order: 2,\n            precision: 20,\n        });\n    }\n\n    _courseDateToPredictorTimestampAndDateTimestamp(date, etfIdentifier) {\n        const timestamp = dateToTimestamp(date);\n        return [\n            timestamp > this.coursePredictors[etfIdentifier].maxTimestampBeforeCoursePredictorRepetition\n                ? this.coursePredictors[etfIdentifier].maxTimestampBeforeCoursePredictorRepetition\n                : timestamp,\n            timestamp,\n        ];\n    }\n\n    _createDividendPredictorIfNotPresent(etfIdentifier, year) {\n        // Skip if already exists.\n        if (year in this.dividendPredictors[etfIdentifier]) {\n            return;\n        }\n        const forecastArray = this.historicalData[etfIdentifier].dividendForecastArray;\n        const lastYearToIncludeInPrediction =\n            forecastArray[forecastArray.length - 1][timestampIndexOfForecastArray] -\n            Math.abs(forecastArray[forecastArray.length - 1][timestampIndexOfForecastArray] - year) *\n                ForecastModelSingleton.backCastTimeFactor -\n            ForecastModelSingleton.backCastTimestampConstant;\n        const filteredForecastArray = forecastArray.filter(\n            entry => entry[timestampIndexOfForecastArray] >= lastYearToIncludeInPrediction\n        );\n        this.dividendPredictors[etfIdentifier][year] = regression.linear(filteredForecastArray, {\n            order: 2,\n            precision: 20,\n        });\n    }\n\n    _dividendYearToPredictorYear(etfIdentifier, year) {\n        return this.dividendPredictors[etfIdentifier].maxYearBeforeDividendPredictorRepetition < year\n            ? this.dividendPredictors[etfIdentifier].maxYearBeforeDividendPredictorRepetition\n            : year;\n    }\n\n    predictCourse(etfIdentifier, date) {\n        if (!(etfIdentifier in this.coursePredictors)) {\n            throw new HistoricalDataNotPresentException(etfIdentifier);\n        }\n        const [predictorTimestamp, timestamp] = this._courseDateToPredictorTimestampAndDateTimestamp(\n            date,\n            etfIdentifier\n        );\n        this._createCoursePredictorIfNotPresent(etfIdentifier, predictorTimestamp);\n        return this.coursePredictors[etfIdentifier][predictorTimestamp].predict(timestamp)[courseIndexOfForecastArray];\n    }\n\n    predictDividend(etfIdentifier, year) {\n        if (!(etfIdentifier in this.dividendPredictors)) {\n            throw new HistoricalDataNotPresentException(etfIdentifier);\n        }\n        const predictorYear = this._dividendYearToPredictorYear(etfIdentifier, year);\n        this._createDividendPredictorIfNotPresent(etfIdentifier, predictorYear);\n        return Math.max(\n            0,\n            this.dividendPredictors[etfIdentifier][predictorYear].predict(year)[courseIndexOfForecastArray]\n        );\n    }\n}\n\nexport default ForecastModelSingleton;\n","import ForecastModelSingleton from './ForecastModel';\nimport { numberOfMonthsOfAYear, isLastMonthOfAYear, clamp, isFirstMonthOfAYear } from '../helpers/utils';\nimport cloneDeep from 'lodash.clonedeep';\n\nconst basicRateOfInterest = 0.007;\nconst partialExemption = 0.7;\nconst corporateTaxRatio = 0.26375;\nconst inflationRate = 0.01;\nconst defaultDividendAmount = 0.025;\n\nfunction getNextMonthDate(date) {\n    const newDate = new Date(date);\n    newDate.setMonth(date.getMonth() + 1);\n    return newDate;\n}\n\nfunction calculateDividend(etfIdentifier, date) {\n    if (!isLastMonthOfAYear(date)) {\n        return 0;\n    } else {\n        const dividendAmount = ForecastModelSingleton.getInstance().predictDividend(etfIdentifier, date.getFullYear());\n        const sharePrize = ForecastModelSingleton.getInstance().predictCourse(etfIdentifier, date);\n        return dividendAmount > 0 ? dividendAmount : defaultDividendAmount * sharePrize;\n    }\n}\n\nfunction calculateCosts(amount, costConfiguration) {\n    let costs = amount * costConfiguration.percentageCosts + costConfiguration.fixedCosts;\n    const amountWithoutCosts = Math.max(amount - costs, 0);\n    costs = amount - amountWithoutCosts;\n    return [amountWithoutCosts, costs];\n}\n\nfunction subtractTaxFreeGain(taxAmount, taxFreeAmount) {\n    const leftoverTaxes = Math.max(0, taxAmount - taxFreeAmount);\n    const leftoverTaxFreeAmount = Math.max(0, taxFreeAmount - taxAmount);\n    return [leftoverTaxes, leftoverTaxFreeAmount];\n}\n\nexport function getTotalShareValue(etfIdentifier, investmentStep) {\n    return investmentStep.totalShares[etfIdentifier] * investmentStep.sharePrizes[etfIdentifier];\n}\n\nexport function getTotalDividenShareValue(etfIdentifier, investmentStep){\n    return investmentStep.dividendTotalShares[etfIdentifier] * investmentStep.sharePrizes[etfIdentifier];\n}\n\nfunction getNewShareValue(etfIdentifier, investmentStep) {\n    return investmentStep.newShares[etfIdentifier] * investmentStep.sharePrizes[etfIdentifier];\n}\n\nfunction sumOfTotalValues(investmentStep) {\n    let sum = 0;\n    for (const etfIdentifier in investmentStep.totalShares) {\n        sum += getTotalShareValue(etfIdentifier, investmentStep);\n    }\n    return sum;\n}\n\nfunction calculateAndAddInflation(investmentStep, initialDate, endDate) {\n    // TODO predict inflationRate??? if so how should I predict it?\n    const sumTotalValues = sumOfTotalValues(investmentStep);\n    const timeFactor =\n        endDate.getFullYear() -\n        initialDate.getFullYear() +\n        (endDate.getMonth() - initialDate.getMonth()) / numberOfMonthsOfAYear;\n    investmentStep.inflation = sumTotalValues - sumTotalValues * Math.pow(1 - inflationRate, timeFactor);\n}\n\nfunction calculateForecastInterval(age, lifeExpectation, savingPhaseLength, fadeOutYears = 10) {\n    const yearsLeft = lifeExpectation - age;\n    const now = new Date();\n    const beginningDate = new Date(now.getFullYear(), now.getMonth() + 1);\n    // start next month.\n    const endSavingPhaseDate = new Date(beginningDate);\n    endSavingPhaseDate.setFullYear(beginningDate.getFullYear() + savingPhaseLength);\n    const endDate = new Date(beginningDate);\n    endDate.setFullYear(beginningDate.getFullYear() + yearsLeft + fadeOutYears);\n    return [beginningDate, endSavingPhaseDate, endDate];\n}\n\nfunction calculateTaxes(investmentSteps, date, leftoverTaxFreeAmount, etfToRatio) {\n    if (!isFirstMonthOfAYear(date) || investmentSteps.length < 2) {\n        return [0, leftoverTaxFreeAmount];\n    }\n    let summedTaxes = 0;\n    const decemberInvestmentStep = investmentSteps[investmentSteps.length - 1];\n    // Use the second investment step if there are not enough meaning the investing started this year after january.\n    // The second is the true first investment step the first is a dummy.\n    const firstInvestmentStepOfThisYear =\n        investmentSteps.length - numberOfMonthsOfAYear > 1\n            ? investmentSteps[investmentSteps.length - numberOfMonthsOfAYear]\n            : investmentSteps[1];\n    for (const etfIdentifier in etfToRatio) {\n        let accumulatedBasicProfit = 0;\n        // Sum up all new investments from february to december.\n        for (let i = 1; i < numberOfMonthsOfAYear && investmentSteps.length - i > 0; i++) {\n            const currentInvestmentStep = investmentSteps[investmentSteps.length - i];\n            accumulatedBasicProfit +=\n                (getNewShareValue(etfIdentifier, currentInvestmentStep) * i) / numberOfMonthsOfAYear;\n        }\n        // Sum up total Investment of the first date of this year.\n        accumulatedBasicProfit +=\n            (getTotalShareValue(etfIdentifier, firstInvestmentStepOfThisYear) *\n                (numberOfMonthsOfAYear - firstInvestmentStepOfThisYear.date.getMonth())) /\n            numberOfMonthsOfAYear;\n        accumulatedBasicProfit *= 0.7 * basicRateOfInterest;\n        const currentShareValues = getTotalShareValue(etfIdentifier, decemberInvestmentStep);\n        // Calculate profit of last year.\n        const profitOverAllTime = currentShareValues - decemberInvestmentStep.totalInvestedMoney[etfIdentifier];\n        let profitOfPreviousYears = 0;\n        if (investmentSteps.length > numberOfMonthsOfAYear) {\n            profitOfPreviousYears = Math.max(\n                0,\n                getTotalShareValue(etfIdentifier, investmentSteps[investmentSteps.length - 1 - numberOfMonthsOfAYear]) -\n                    investmentSteps[investmentSteps.length - 1 - numberOfMonthsOfAYear].totalInvestedMoney[\n                        etfIdentifier\n                    ]\n            );\n        }\n\n        const profitOfThisYear = profitOverAllTime - profitOfPreviousYears;\n        let amountToApplyTaxes = clamp(profitOfThisYear, 0, accumulatedBasicProfit);\n        [amountToApplyTaxes, leftoverTaxFreeAmount] = subtractTaxFreeGain(amountToApplyTaxes, leftoverTaxFreeAmount);\n        summedTaxes += amountToApplyTaxes * partialExemption * corporateTaxRatio;\n    }\n    return [summedTaxes, leftoverTaxFreeAmount];\n}\n\nexport function addAccumulationMonth(investmentSteps, investment, date, initialDate, etfToRatio, configOptions) {\n    const forecast = ForecastModelSingleton.getInstance();\n    let costs = 0;\n    const prevInvestmentStep = investmentSteps[investmentSteps.length - 1];\n    const newInvestmentStep = {\n        date: date,\n        newShares: {},\n        totalShares: { ...prevInvestmentStep.totalShares },\n        dividendNewShares: {},\n        dividendTotalShares: { ...prevInvestmentStep.dividendTotalShares },\n        totalCosts: prevInvestmentStep.totalCosts,\n        sharePrizes: {},\n        totalInvestedMoney: { ...prevInvestmentStep.totalInvestedMoney },\n        newInvestedMoney: {},\n        newInvestment: 0,\n        totalTaxes: prevInvestmentStep.totalTaxes,\n        totalPayout: { ...prevInvestmentStep.totalPayout },\n        newPayout: {},\n    };\n    for (const etfIdentifier in etfToRatio) {\n        const investmentOfEtfWithCosts = etfToRatio[etfIdentifier] * investment;\n        newInvestmentStep.newInvestment += investmentOfEtfWithCosts;\n        const [investmentOfEtfWithoutCosts, newCosts] = calculateCosts(\n            investmentOfEtfWithCosts,\n            configOptions.costConfig\n        );\n        costs += newCosts;\n        newInvestmentStep.newInvestedMoney[etfIdentifier] = investmentOfEtfWithoutCosts;\n        newInvestmentStep.totalInvestedMoney[etfIdentifier] += investmentOfEtfWithoutCosts;\n\n        const etfSharePrize = forecast.predictCourse(etfIdentifier, date);\n        const newShares = investmentOfEtfWithoutCosts / etfSharePrize;\n        newInvestmentStep.sharePrizes[etfIdentifier] = etfSharePrize;\n        newInvestmentStep.newShares[etfIdentifier] = newShares;\n\n        const dividendPayoutMoneyPerShare = calculateDividend(etfIdentifier, date);\n        const dividendPayoutMoney = newInvestmentStep.totalShares[etfIdentifier] * dividendPayoutMoneyPerShare;\n        const newSharesByDividend = dividendPayoutMoney / etfSharePrize;\n        newInvestmentStep.newShares[etfIdentifier] += newSharesByDividend;\n        newInvestmentStep.dividendNewShares[etfIdentifier] = newSharesByDividend;\n        newInvestmentStep.dividendTotalShares[etfIdentifier] += newSharesByDividend;\n\n        newInvestmentStep.totalShares[etfIdentifier] += newInvestmentStep.newShares[etfIdentifier];\n        newInvestmentStep.newPayout[etfIdentifier] = 0;\n    }\n    newInvestmentStep.totalCosts += costs;\n    const [newTaxes, newLeftoverTaxFreeAmount] = calculateTaxes(\n        investmentSteps,\n        date,\n        configOptions.taxFreeAmount,\n        etfToRatio\n    );\n    newInvestmentStep.totalTaxes += newTaxes;\n    calculateAndAddInflation(newInvestmentStep, initialDate, date);\n    investmentSteps.push(newInvestmentStep);\n\n    return newLeftoverTaxFreeAmount;\n}\n\nfunction addPayoutMonth(\n    investmentSteps,\n    sellingAmount,\n    etfToRatio,\n    date,\n    initialDate,\n    configOptions,\n    leftoverAlreadyPaidTaxes,\n    leftoverTaxFreeAmount,\n    payoutStats\n) {\n    if (isFirstMonthOfAYear(date)) {\n        leftoverTaxFreeAmount = configOptions.taxFreeAmount;\n    }\n    const forecast = ForecastModelSingleton.getInstance();\n    let costs = 0;\n    let taxes = 0;\n    const prevInvestmentStep = investmentSteps[investmentSteps.length - 1];\n    const newInvestmentStep = {\n        date: date,\n        newShares: {},\n        totalShares: { ...prevInvestmentStep.totalShares },\n        dividendNewShares: {},\n        dividendTotalShares: { ...prevInvestmentStep.dividendTotalShares },\n        totalCosts: prevInvestmentStep.totalCosts,\n        sharePrizes: {},\n        totalInvestedMoney: { ...prevInvestmentStep.totalInvestedMoney },\n        newInvestedMoney: {},\n        newInvestment: 0,\n        totalTaxes: prevInvestmentStep.totalTaxes,\n        totalPayout: { ...prevInvestmentStep.totalPayout },\n        newPayout: {},\n    };\n    for (const etfIdentifier in etfToRatio) {\n        const etfSharePrize = forecast.predictCourse(etfIdentifier, date);\n        newInvestmentStep.sharePrizes[etfIdentifier] = etfSharePrize;\n        newInvestmentStep.newPayout[etfIdentifier] = 0;\n        newInvestmentStep.newInvestedMoney[etfIdentifier] = 0;\n        // Skip payout if there are no shares left to sell.\n        if (payoutStats[etfIdentifier].investmentStepsIdx < investmentSteps.length) {\n            // Handle payout.\n            const amountToSell = sellingAmount * etfToRatio[etfIdentifier];\n            let amountAlreadySold = 0;\n            const costsToPay = calculateCosts(amountToSell, configOptions.costConfig)[1];\n            let alreadyPaidCosts = 0;\n            let payoutInvestmentStepIdxForFIFO = payoutStats[etfIdentifier].investmentStepsIdx;\n            let currentSharesLeft =\n                investmentSteps[payoutInvestmentStepIdxForFIFO].newShares[etfIdentifier] -\n                payoutStats[etfIdentifier].alreadySoldShares;\n            for (; payoutInvestmentStepIdxForFIFO < investmentSteps.length; payoutInvestmentStepIdxForFIFO++) {\n                const leftoverAmountToSell = amountToSell - amountAlreadySold;\n                const currentInvestmentStepForFIFO = investmentSteps[payoutInvestmentStepIdxForFIFO];\n\n                const currentValueOfShares =\n                    etfSharePrize *\n                    (payoutInvestmentStepIdxForFIFO === payoutStats[etfIdentifier].investmentStepsIdx\n                        ? currentInvestmentStepForFIFO.newShares[etfIdentifier] -\n                          payoutStats[etfIdentifier].alreadySoldShares\n                        : currentInvestmentStepForFIFO.newShares[etfIdentifier]);\n                const amountToSellWithCosts = Math.min(currentValueOfShares, leftoverAmountToSell);\n                const amountOfSharesToSell = amountToSellWithCosts / etfSharePrize;\n                currentSharesLeft = currentInvestmentStepForFIFO.newShares[etfIdentifier] - amountOfSharesToSell;\n                currentSharesLeft -=\n                    payoutInvestmentStepIdxForFIFO === payoutStats[etfIdentifier].investmentStepsIdx\n                        ? payoutStats[etfIdentifier].alreadySoldShares\n                        : 0;\n\n                const amountToSellWithoutCosts = Math.max(0, amountToSellWithCosts - (costsToPay - alreadyPaidCosts));\n                alreadyPaidCosts += Math.max(0, amountToSellWithCosts - amountToSellWithoutCosts);\n\n                const initialValueOfShares =\n                    amountOfSharesToSell * currentInvestmentStepForFIFO.sharePrizes[etfIdentifier];\n                let amountToPayTaxes = Math.max(0, amountToSellWithoutCosts - initialValueOfShares);\n\n                [amountToPayTaxes, leftoverTaxFreeAmount] = subtractTaxFreeGain(\n                    amountToPayTaxes,\n                    leftoverTaxFreeAmount\n                );\n                let taxesToPay = amountToPayTaxes * partialExemption * corporateTaxRatio;\n                [taxesToPay, leftoverAlreadyPaidTaxes] = subtractTaxFreeGain(taxesToPay, leftoverAlreadyPaidTaxes);\n                taxes += taxesToPay;\n                const payoutAmount = amountToSellWithoutCosts - taxesToPay;\n\n                newInvestmentStep.newPayout[etfIdentifier] += payoutAmount;\n                newInvestmentStep.totalPayout[etfIdentifier] += payoutAmount;\n\n                newInvestmentStep.totalShares[etfIdentifier] -= amountOfSharesToSell;\n                amountAlreadySold += amountToSellWithCosts;\n\n                // Handle the decrease of the dividendShares.\n                let amountOfDividendSharesLeft = 0;\n                if (payoutInvestmentStepIdxForFIFO === payoutStats[etfIdentifier].investmentStepsIdx) {\n                    amountOfDividendSharesLeft = Math.max(\n                        0,\n                        currentInvestmentStepForFIFO.dividendNewShares[etfIdentifier] -\n                            payoutStats[etfIdentifier].alreadySoldShares\n                    );\n                } else {\n                    amountOfDividendSharesLeft = currentInvestmentStepForFIFO.dividendNewShares[etfIdentifier];\n                }\n                const amountOfDividendSharesSold = Math.min(amountOfDividendSharesLeft, amountOfSharesToSell);\n                newInvestmentStep.dividendTotalShares[etfIdentifier] -= amountOfDividendSharesSold;\n\n                // Use break in order to not change the value of payoutInvestmentStepIdxForFIFO.\n                if (amountAlreadySold >= amountToSell) {\n                    break;\n                }\n            }\n            costs += alreadyPaidCosts;\n            // Handle update payoutStats.\n            payoutStats[etfIdentifier].investmentStepsIdx = payoutInvestmentStepIdxForFIFO;\n            payoutStats[etfIdentifier].investmentStepsIdx += currentSharesLeft === 0 ? 1 : 0;\n\n            payoutStats[etfIdentifier].alreadySoldShares =\n                payoutInvestmentStepIdxForFIFO < investmentSteps.length\n                    ? investmentSteps[payoutInvestmentStepIdxForFIFO].newShares[etfIdentifier] - currentSharesLeft\n                    : 0;\n        }\n\n        // Handle dividend.\n        const dividendPayoutMoney =\n            newInvestmentStep.totalShares[etfIdentifier] * calculateDividend(etfIdentifier, date);\n        const newSharesByDividend = dividendPayoutMoney / etfSharePrize;\n        newInvestmentStep.newShares[etfIdentifier] = newSharesByDividend;\n        newInvestmentStep.totalShares[etfIdentifier] += newSharesByDividend;\n        newInvestmentStep.dividendNewShares[etfIdentifier] = newSharesByDividend;\n        newInvestmentStep.dividendTotalShares[etfIdentifier] += newSharesByDividend;\n    }\n\n    newInvestmentStep.totalCosts += costs;\n    newInvestmentStep.totalTaxes += taxes;\n    calculateAndAddInflation(newInvestmentStep, initialDate, date);\n    investmentSteps.push(newInvestmentStep);\n    return [leftoverAlreadyPaidTaxes, leftoverTaxFreeAmount];\n}\n\nfunction generateEmptyInvestmentStep(etfToRatio, date) {\n    const forecast = ForecastModelSingleton.getInstance();\n    const emptyInvestmentStep = {\n        date: date,\n        totalCosts: 0,\n        totalTaxes: 0,\n        newShares: {},\n        totalShares: {},\n        dividendNewShares: {},\n        dividendTotalShares: {},\n        totalInvestedMoney: {},\n        totalPayout: {},\n        newPayout: {},\n        sharePrizes: {},\n        newInvestedMoney: {},\n        newInvestment: 0,\n    };\n    for (const etfIdentifier in etfToRatio) {\n        emptyInvestmentStep.newShares[etfIdentifier] = 0;\n        emptyInvestmentStep.totalShares[etfIdentifier] = 0;\n        emptyInvestmentStep.dividendNewShares[etfIdentifier] = 0;\n        emptyInvestmentStep.dividendTotalShares[etfIdentifier] = 0;\n        emptyInvestmentStep.totalInvestedMoney[etfIdentifier] = 0;\n        emptyInvestmentStep.totalPayout[etfIdentifier] = 0;\n        emptyInvestmentStep.newPayout[etfIdentifier] = 0;\n        emptyInvestmentStep.newInvestedMoney[etfIdentifier] = 0;\n        emptyInvestmentStep.sharePrizes[etfIdentifier] = forecast.predictCourse(etfIdentifier, date);\n    }\n    return emptyInvestmentStep;\n}\n\nexport class InvestmentModel {\n    constructor(\n        startCapital,\n        monthlyInvestment,\n        monthlyPayout,\n        savingPhaseLength,\n        etfToRatio,\n        configOptions,\n        age,\n        expectationOfLife\n    ) {\n        this.startCapital = startCapital;\n        this.monthlyInvestment = monthlyInvestment;\n        this.monthlyPayout = monthlyPayout;\n        this.savingPhaseLength = savingPhaseLength;\n        this.etfToRatio = etfToRatio;\n        this.configOptions = configOptions;\n        this.expectationOfLife = expectationOfLife;\n        this.age = age;\n        this._calculateTimestampsForModel();\n        this._calculateModel();\n    }\n\n    _calculateTimestampsForModel() {\n        const [startDate, endSavingPhaseDate, endDate] = calculateForecastInterval(\n            this.age,\n            this.expectationOfLife,\n            this.savingPhaseLength\n        );\n        const savingDates = [];\n        for (\n            let currentDate = startDate;\n            currentDate < endSavingPhaseDate;\n            currentDate = getNextMonthDate(currentDate)\n        ) {\n            savingDates.push(currentDate);\n        }\n        this.savingDates = savingDates;\n        const payoutDates = [];\n        for (let currentDate = endSavingPhaseDate; currentDate < endDate; currentDate = getNextMonthDate(currentDate)) {\n            payoutDates.push(currentDate);\n        }\n        this.payoutDates = payoutDates;\n        this.initialDate = startDate;\n    }\n\n    _calculateModel() {\n        let investmentSteps = [generateEmptyInvestmentStep(this.etfToRatio, this.savingDates[0])];\n        addAccumulationMonth(\n            investmentSteps,\n            this.monthlyInvestment + this.startCapital,\n            this.savingDates[0],\n            this.initialDate,\n            this.etfToRatio,\n            this.configOptions\n        );\n        for (const savingDate of this.savingDates.slice(1)) {\n            addAccumulationMonth(\n                investmentSteps,\n                this.monthlyInvestment,\n                savingDate,\n                this.initialDate,\n                this.etfToRatio,\n                this.configOptions\n            );\n        }\n        // Discard the empty investment step.\n        investmentSteps = investmentSteps.slice(1);\n\n        let leftoverAlreadyPaidTaxes = investmentSteps[investmentSteps.length - 1].totalTaxes;\n        let leftoverTaxFreeAmount = this.configOptions.taxFreeAmount;\n        const payoutStats = {};\n        for (const etfIdentifier in this.etfToRatio) {\n            payoutStats[etfIdentifier] = { investmentStepsIdx: 0, alreadySoldShares: 0 };\n        }\n        for (const payoutDate of this.payoutDates) {\n            [leftoverAlreadyPaidTaxes, leftoverTaxFreeAmount] = addPayoutMonth(\n                investmentSteps,\n                this.monthlyPayout,\n                this.etfToRatio,\n                payoutDate,\n                this.initialDate,\n                this.configOptions,\n                leftoverAlreadyPaidTaxes,\n                leftoverTaxFreeAmount,\n                payoutStats\n            );\n        }\n        this.investmentSteps = investmentSteps;\n    }\n\n    getInvestmentSteps(numberOfEntriesPerYear) {\n        if (!Number.isInteger(numberOfMonthsOfAYear / numberOfEntriesPerYear)) {\n            throw new Error(\n                `The numberOfEntriesPerYear need to be dividable by ${numberOfMonthsOfAYear} in order to make sense.`\n            );\n        }\n\n        if (numberOfEntriesPerYear === numberOfMonthsOfAYear) {\n            return this.investmentSteps;\n        }\n        const selectedInvestmentSteps = [];\n        const numberOfMonthsToMerge = numberOfMonthsOfAYear / numberOfEntriesPerYear;\n        for (let i = 0; i < this.investmentSteps.length; i += numberOfMonthsToMerge) {\n            // Take the start date as representative.\n            const adjustedInvestmentStep = cloneDeep(this.investmentSteps[i]);\n            for (let offset = 1; offset < numberOfMonthsToMerge; offset++) {\n                adjustedInvestmentStep.newInvestment += this.investmentSteps[i + offset].newInvestment;\n                for (const etfIdentifier in this.investmentSteps[i + offset].newPayout) {\n                    adjustedInvestmentStep.newPayout[etfIdentifier] += this.investmentSteps[i + offset].newPayout[\n                        etfIdentifier\n                    ];\n                }\n            }\n            selectedInvestmentSteps.push(adjustedInvestmentStep);\n        }\n        return selectedInvestmentSteps;\n    }\n}\n","import * as d3 from 'd3';\nimport { roundDateToBeginningOfMonth, numberOfMonthsOfAYear } from '../helpers/utils';\n\nconst FIVE_MILLION = 5000000;\nconst ONE_THOUSAND = 1000;\nconst ONE_MILLION = 1000000;\nconst numberOfTicks = 7;\n\nfunction setInteractionDisplayForActiveDiagrams(displayOption) {\n    for (const activeDiagram of D3ChartStrategy.activeStrategies) {\n        activeDiagram.interaction.style('display', displayOption);\n    }\n}\n\nfunction calculateInvestmentStepIndexForDate(date, investmentSteps) {\n    const firstDate = investmentSteps[0].date;\n    const secondDate = investmentSteps[1].date;\n    const numberOfMonthsSinceStartDate =\n        (date.getFullYear() - firstDate.getFullYear()) * numberOfMonthsOfAYear +\n        (date.getMonth() - firstDate.getMonth());\n    const numberOfMonthsPerInvestmentStep =\n        (secondDate.getFullYear() - firstDate.getFullYear()) * numberOfMonthsOfAYear +\n        (secondDate.getMonth() - firstDate.getMonth());\n\n    return Math.floor(numberOfMonthsSinceStartDate / numberOfMonthsPerInvestmentStep);\n}\n\nexport class D3ChartStrategy {\n    static activeStrategies = [];\n    constructor(\n        investmentSteps,\n        renderDivRef,\n        payoutPhaseStartDate,\n        svgID,\n        width = 1100,\n        height = 300,\n        marginW = 200,\n        marginH = 40\n    ) {\n        if (this.constructor === D3ChartStrategy) {\n            throw new Error(\"Abstract classes can't be instantiated.\");\n        }\n        D3ChartStrategy.activeStrategies.push(this);\n        this.investmentSteps = investmentSteps;\n        this.payoutPhaseStartDate = payoutPhaseStartDate;\n\n        this.marginW = marginW;\n        this.marginH = marginH;\n        this.width = width;\n        this.height = height;\n\n        this.lineStrokeWidth = 3;\n        this.labelValueIdentifier = 'value';\n\n        // Reset diagram by deletion.\n        renderDivRef.innerHTML = '';\n\n        this.svg = d3\n            .select(renderDivRef)\n            .append('svg')\n            .attr('id', svgID)\n            .attr('viewBox', `0 0 ${this.width + 2 * this.marginW} ${this.height + 2 * this.marginH}`)\n            .append('g')\n            .attr('transform', `translate(${[this.marginW / 2, this.marginH]})`);\n    }\n\n    static reset() {\n        D3ChartStrategy.activeStrategies = [];\n    }\n\n    render() {\n        this._prepareData();\n        this._calculateExtents();\n        this._createScales();\n        this._drawContent();\n        this._prepareText();\n        this._drawText();\n        this._drawAxis();\n        this._addInteraction();\n    }\n\n    _calculateExtents() {\n        this.dateExtent = d3.extent(this.dataArray[0], d => d.date);\n\n        const lastImportantDateForYScale = new Date(this.payoutPhaseStartDate);\n        lastImportantDateForYScale.setMonth(lastImportantDateForYScale.getMonth() + numberOfMonthsOfAYear);\n        const filteredDataArrayForYMax = this.dataArray[this.maxIndex].filter(\n            e => e.date <= lastImportantDateForYScale && e.date > this.dateExtent[0]\n        );\n        const filteredDataArrayForYMin = this.dataArray[this.minIndex].filter(\n            e => e.date <= lastImportantDateForYScale\n        );\n        const maxVal = d3.max(filteredDataArrayForYMax.map(e => e.yStart));\n        const minVal = d3.min(filteredDataArrayForYMin.map(e => e.yEnd));\n        this.yExtent = [minVal, maxVal];\n    }\n\n    _createScales() {\n        this.yScale = d3.scaleLinear().domain(this.yExtent).range([this.height, 0]);\n        this.xScale = d3.scaleTime().domain(this.dateExtent).range([0, this.width]);\n    }\n\n    valueToDisplayText(value, hasToBePositive = false) {\n        const labelDivisionFactor =\n            Math.max(-this.yExtent[0], this.yExtent[1]) >= FIVE_MILLION ? ONE_MILLION : ONE_THOUSAND;\n        const numberIndicator = labelDivisionFactor === ONE_MILLION ? 'M' : 'K';\n        if(hasToBePositive){\n            value = Math.abs(value);\n        }\n        return `${(value / labelDivisionFactor).toLocaleString(undefined, {\n            maximumFractionDigits: 2,\n        })}${numberIndicator} `;\n    }\n\n    _drawAxis() {\n        this.svg\n            .append('g')\n            .style('font-size', '20px')\n            .call(\n                d3\n                    .axisLeft(this.yScale)\n                    .tickFormat(d => this.valueToDisplayText(d))\n                    .ticks(numberOfTicks)\n            );\n\n        this.svg\n            .append('g')\n            .style('font-size', '20px')\n            .attr('transform', `translate(0, ${this.height})`)\n            .call(d3.axisBottom(this.xScale));\n\n        // Draw zero line.\n        this.svg\n            .append('g')\n            .append('line')\n            .attr('x1', this.xScale(this.dateExtent[0]))\n            .attr('y1', this.yScale(0))\n            .attr('x2', this.xScale(this.dateExtent[1]))\n            .attr('y2', this.yScale(0))\n            .style('stroke-width', this.lineStrokeWidth)\n            .style('stroke', 'black');\n\n        // Draw phase division line.\n        this.svg\n            .append('g')\n            .append('line')\n            .attr('x1', this.xScale(this.payoutPhaseStartDate) - this.lineStrokeWidth / 2)\n            .attr('y1', this.yScale(this.yExtent[0]))\n            .attr('x2', this.xScale(this.payoutPhaseStartDate) - this.lineStrokeWidth / 2)\n            .attr('y2', this.yScale(this.yExtent[1]))\n            .style('stroke-width', this.lineStrokeWidth)\n            .style('stroke', 'black');\n    }\n\n    _addInteraction() {\n        const interactionClass = 'interaction';\n        const tooltipLineClass = 'tooltipLine';\n\n        this.interaction = this.svg\n            .append('g')\n            .attr('class', interactionClass)\n            .style('display', 'none')\n            .attr('transform', `translate(${[0, -this.marginH]})`);\n\n        this.hoverLine = this.interaction\n            .append('line')\n            .attr('class', tooltipLineClass)\n            .style('stroke', 'blue')\n            .style('stroke-dasharray', '3,3')\n            .style('opacity', 0.5)\n            .attr('y1', this.height + 2 * this.marginH)\n            .attr('y2', 0);\n\n        // Add rectangle to catch mouse events.\n        this.svg\n            .append('rect')\n            .attr('class', 'mouseEvent')\n            .attr('transform', `translate(${[0, -this.marginH]})`)\n            .attr('height', this.height + 2 * this.marginH)\n            .attr('width', this.width)\n            .attr('fill', 'none')\n            .style('pointer-events', 'all')\n            .on('mouseover', () => setInteractionDisplayForActiveDiagrams(null))\n            .on('mouseout', () => setInteractionDisplayForActiveDiagrams('none'))\n            .on('mousemove', mouseEvent => this._handleTooltipEvent(mouseEvent));\n    }\n\n    // Interaction inspired by: http://www.d3noob.org/2014/07/my-favourite-tooltip-method-for-line.html\n    _handleTooltipEvent(mouseEvent) {\n        const x = d3.pointer(mouseEvent)[0];\n        const date = this.xScale.invert(x);\n        const roundedDate = roundDateToBeginningOfMonth(date);\n        const investmentStepIndex = calculateInvestmentStepIndexForDate(roundedDate, this.investmentSteps);\n        for (const activeDiagram of D3ChartStrategy.activeStrategies) {\n            activeDiagram.hoverLine.attr('x1', this.xScale(roundedDate)).attr('x2', this.xScale(roundedDate));\n            activeDiagram._updateTooltip(investmentStepIndex);\n            activeDiagram._updateText();\n        }\n    }\n\n    _drawText() {\n        this.textGroup = this.svg.append('g').attr('class', 'textGroup');\n        this.textGroup\n            .selectAll('text')\n            .data(Object.values(this.textProperties))\n            .enter()\n            .append('text')\n            .text(d => d.text)\n            .attr('x', d => d.x)\n            .attr('y', d => d.y)\n            .style('font-size', d => d.fontSize)\n            .style('font-weight', d => d.fontWeight)\n            .style('text-anchor', d => d.textAnchor)\n            .style('fill', d => d.color);\n    }\n\n    _updateText() {\n        this.textGroup.selectAll('text').text(d => d.text);\n    }\n\n    _prepareText() {\n        const savingPhaseMid =\n            this.xScale(this.dateExtent[0]) +\n            (this.xScale(this.payoutPhaseStartDate) - this.xScale(this.dateExtent[0])) / 2;\n\n        const payoutPhaseMid =\n            this.xScale(this.payoutPhaseStartDate) +\n            (this.xScale(this.dateExtent[1]) - this.xScale(this.payoutPhaseStartDate)) / 2;\n        const yPos = -10;\n        this.standardFontSize = 20;\n        this.textProperties = {\n            saving: {\n                text: 'SAVING',\n                x: savingPhaseMid,\n                y: yPos,\n                fontSize: this.standardFontSize,\n                textAnchor: 'end',\n                fontWeight: 'bold',\n                color: 'black',\n            },\n            savingPhase: {\n                text: 'Phase',\n                x: savingPhaseMid,\n                y: yPos,\n                fontSize: this.standardFontSize,\n                textAnchor: 'start',\n                fontWeight: 'normal',\n                color: 'black',\n            },\n            payout: {\n                text: 'PAYOUT',\n                x: payoutPhaseMid,\n                y: yPos,\n                fontSize: this.standardFontSize,\n                textAnchor: 'end',\n                fontWeight: 'bold',\n                color: 'black',\n            },\n            payoutPhase: {\n                text: 'Phase',\n                x: payoutPhaseMid,\n                y: yPos,\n                fontSize: this.standardFontSize,\n                textAnchor: 'start',\n                fontWeight: 'normal',\n                color: 'black',\n            },\n        };\n    }\n\n    _prepareData() {\n        throw new Error('Abstract method. Not Implemented');\n    }\n\n    _drawContent() {\n        throw new Error('Abstract method. Not Implemented');\n    }\n\n    _updateTooltip() {\n        throw new Error('Abstract method. Not Implemented');\n    }\n}\n","import * as d3 from 'd3';\nimport { getTotalShareValue, getTotalDividenShareValue } from '../model/InvestmentModel';\nimport { D3ChartStrategy } from './D3ChartStrategy';\nimport { ETF_SYMBOL_TO_NAME } from '../components/App';\n\nfunction generateEtfValueText(investmentValue = undefined, totalValue = undefined) {\n    return `Inv: ${investmentValue == null ? '-' : investmentValue}, Tot: ${totalValue == null ? '-' : totalValue}`;\n}\n\nfunction generateNegativeLabelText(name, value = undefined) {\n    return `${name.charAt(0).toUpperCase()}${name.slice(1)}: ${value == null ? '-' : value}`;\n}\n\nconst negativeLabels = ['costs', 'taxes', 'inflation'];\nconst negativeLabelsToInvestmentStepIdentifier = { costs: 'totalCosts', taxes: 'totalTaxes', inflation: 'inflation' };\nconst capitalIdentifier = 'capital';\nconst investedIdentifier = 'invested';\n\nexport class LineChartD3 extends D3ChartStrategy {\n    constructor(investmentSteps, renderDivRef, payoutPhaseStartDate) {\n        super(investmentSteps, renderDivRef, payoutPhaseStartDate, 'firstSVG');\n\n        this.etfLineColors = {\n            'SP5C.PAR': { total: '#0562a0', invested: '#71c1f7' },\n            ESGE: { total: '#ff1eff', invested: '#ff63ff' },\n            SUSA: { total: '#23ff01', invested: '#7dff69' },\n        };\n        this.colors = { inflation: '#ff7f00', costs: '#be3bff', taxes: '#e31a1c' };\n        this.lineOpacity = 0.7;\n\n        this.etfIdentifiers = Object.keys(this.investmentSteps[0].totalShares);\n    }\n\n    _prepareData() {\n        this.dataToIndex = {\n            costs: 0,\n            taxes: 1,\n            inflation: 2,\n        };\n\n        let currentIdx = 3;\n        for (const etfIdentifier of this.etfIdentifiers) {\n            this.dataToIndex[etfIdentifier + investedIdentifier] = currentIdx++;\n            this.dataToIndex[etfIdentifier + capitalIdentifier] = currentIdx++;\n        }\n\n        this.minIndex = this.dataToIndex.inflation;\n        this.maxIndex = currentIdx - 1;\n\n        this.dataArray = [];\n        for (let i = 0; i < currentIdx; i++) {\n            this.dataArray.push([]);\n        }\n        for (const investmentStep of this.investmentSteps) {\n            this.dataArray[this.dataToIndex.costs].push({\n                yStart: 0,\n                yEnd: -investmentStep.totalCosts,\n                date: investmentStep.date,\n            });\n            this.dataArray[this.dataToIndex.taxes].push({\n                yStart: -investmentStep.totalCosts,\n                yEnd: -investmentStep.totalCosts - investmentStep.totalTaxes,\n                date: investmentStep.date,\n            });\n            this.dataArray[this.dataToIndex.inflation].push({\n                yStart: -investmentStep.totalCosts - investmentStep.totalTaxes,\n                yEnd: -investmentStep.totalCosts - investmentStep.totalTaxes - investmentStep.inflation,\n                date: investmentStep.date,\n            });\n            let heightOffset = 0;\n            for (const etfIdentifier in investmentStep.totalShares) {\n                const totalShareValue = getTotalShareValue(etfIdentifier, investmentStep);\n                const totalDividendShareValue = getTotalDividenShareValue(etfIdentifier, investmentStep);\n                this.dataArray[this.dataToIndex[etfIdentifier + capitalIdentifier]].push({\n                    yStart: totalShareValue + heightOffset,\n                    yEnd: totalShareValue - totalDividendShareValue + heightOffset,\n                    date: investmentStep.date,\n                });\n                this.dataArray[this.dataToIndex[etfIdentifier + investedIdentifier]].push({\n                    yStart: totalShareValue - totalDividendShareValue + heightOffset,\n                    yEnd: heightOffset,\n                    date: investmentStep.date,\n                });\n                heightOffset += totalShareValue;\n            }\n        }\n\n        // Append miscellaneous data to array.\n        this.dataArray[this.dataToIndex.inflation].color = this.colors.inflation;\n        this.dataArray[this.dataToIndex.taxes].color = this.colors.taxes;\n        this.dataArray[this.dataToIndex.costs].color = this.colors.costs;\n        for (const etfIdentifier in this.investmentSteps[0].totalShares) {\n            this.dataArray[this.dataToIndex[etfIdentifier + investedIdentifier]].color = this.etfLineColors[\n                etfIdentifier\n            ].invested;\n            this.dataArray[this.dataToIndex[etfIdentifier + capitalIdentifier]].color = this.etfLineColors[\n                etfIdentifier\n            ].total;\n        }\n    }\n\n    _drawLines() {\n        // Draw line chart.\n        for (let i = 0; i < this.dataArray.length; i++) {\n            this.svg\n                .append('path')\n                .datum(this.dataArray[i])\n                .style('stroke', d => d.color)\n                .style('stroke-width', this.lineStrokeWidth)\n                .style('opacity', this.lineOpacity)\n                .style('fill', 'none')\n                .attr(\n                    'd',\n                    d3\n                        .line()\n                        .x(d => this.xScale(d.date))\n                        .y(d => this.yScale(d.yStart))\n                );\n        }\n    }\n    _drawContent() {\n        this._drawArea();\n    }\n\n    _drawArea() {\n        // Draw stacked area chart.\n        for (let i = 0; i < this.dataArray.length; i++) {\n            this.svg\n                .append('g')\n                .attr('class', 'area')\n                .append('path')\n                .datum(this.dataArray[i])\n                .style('opacity', this.lineOpacity)\n                .style('fill', d => d.color)\n                .attr(\n                    'd',\n                    d3\n                        .area()\n                        .curve(d3.curveMonotoneX)\n                        .x(d => this.xScale(d.date))\n                        .y0(d => this.yScale(d.yEnd))\n                        .y1(d => this.yScale(d.yStart))\n                );\n        }\n    }\n\n    _prepareText() {\n        super._prepareText();\n        const paddingW = this.width * 0.005;\n        const paddingH = this.standardFontSize * 0.3;\n\n        for (let i = 0; i < negativeLabels.length; i++) {\n            this.textProperties[negativeLabels[i]] = {\n                text: generateNegativeLabelText(negativeLabels[i]),\n                x: this.xScale(this.dateExtent[1]) + paddingW,\n                y: this.yScale(0) + (this.standardFontSize + paddingH) * i + this.standardFontSize,\n                fontSize: this.standardFontSize,\n                textAnchor: 'start',\n                fontWeight: 'normal',\n                color: this.colors[negativeLabels[i]],\n            };\n        }\n\n        // Add ETF Labels.\n        for (let i = 0; i < this.etfIdentifiers.length; i++) {\n            this.textProperties[this.etfIdentifiers[i]] = {\n                text: ETF_SYMBOL_TO_NAME[this.etfIdentifiers[i]],\n                x: this.xScale(this.dateExtent[1]) + paddingW,\n                y: this.yScale(0) - (this.standardFontSize + paddingH) * i * 2 - 2 * this.standardFontSize,\n                fontSize: this.standardFontSize,\n                textAnchor: 'start',\n                fontWeight: 'normal',\n                color: this.etfLineColors[this.etfIdentifiers[i]].total,\n            };\n        }\n\n        // Add ETF values of Labels.\n        for (let i = 0; i < this.etfIdentifiers.length; i++) {\n            this.textProperties[this.etfIdentifiers[i] + this.labelValueIdentifier] = {\n                text: generateEtfValueText(),\n                x: this.xScale(this.dateExtent[1]) + paddingW,\n                y: this.yScale(0) - (this.standardFontSize + paddingH) * i * 2 - 1 * this.standardFontSize,\n                fontSize: this.standardFontSize,\n                textAnchor: 'start',\n                fontWeight: 'normal',\n                color: this.etfLineColors[this.etfIdentifiers[i]].total,\n            };\n        }\n    }\n\n    _updateTooltip(investmentStepIndex) {\n        console.log(this.investmentSteps);\n        for (const etfIdentifier of this.etfIdentifiers) {\n            const totalValue = getTotalShareValue(etfIdentifier, this.investmentSteps[investmentStepIndex]);\n            const totalDividendValue = getTotalDividenShareValue(\n                etfIdentifier,\n                this.investmentSteps[investmentStepIndex]\n            );\n            const investedValue = totalValue - totalDividendValue;\n            const updatedValueText = generateEtfValueText(\n                this.valueToDisplayText(investedValue, true),\n                this.valueToDisplayText(totalValue, true)\n            );\n            this.textProperties[etfIdentifier + this.labelValueIdentifier].text = updatedValueText;\n        }\n        for (const negativeLabel of negativeLabels) {\n            const value = this.investmentSteps[investmentStepIndex][\n                negativeLabelsToInvestmentStepIdentifier[negativeLabel]\n            ];\n            const updatedValueText = generateNegativeLabelText(negativeLabel, this.valueToDisplayText(value, true));\n            this.textProperties[negativeLabel].text = updatedValueText;\n        }\n    }\n}\n\nexport default LineChartD3;\n","import { D3ChartStrategy } from './D3ChartStrategy';\n\nexport class CashflowBarChart extends D3ChartStrategy {\n    constructor(investmentSteps, renderDivRef, payoutPhaseStartDate) {\n        super(investmentSteps, renderDivRef, payoutPhaseStartDate, 'secondSVG');\n        this.barPaddingPercentage = 0.9;\n\n        this.zeroLineStrokeWidth = 3;\n    }\n\n    render() {\n        super.render();\n    }\n\n    _prepareData() {\n        // Create line array.\n        const dataToIndex = {\n            invested: 0,\n            payout: 1,\n        };\n\n        this.minIndex = dataToIndex.invested;\n        this.maxIndex = dataToIndex.payout;\n\n        this.dataArray = [[], []];\n        for (const investmentStep of this.investmentSteps) {\n            let sumNewPayout = 0;\n            for (const etfIdentifier in investmentStep.newPayout) {\n                sumNewPayout += investmentStep.newPayout[etfIdentifier];\n            }\n            this.dataArray[dataToIndex.invested].push({\n                yStart: 0,\n                yEnd: -investmentStep.newInvestment,\n                date: investmentStep.date,\n                color: '#ff3e58',\n            });\n            this.dataArray[dataToIndex.payout].push({\n                yStart: sumNewPayout,\n                yEnd: 0,\n                date: investmentStep.date,\n                color: '#abff9e',\n            });\n        }\n\n        this.rectWidth = (this.width / this.dataArray[dataToIndex.invested].length) * this.barPaddingPercentage;\n    }\n\n    _drawContent() {\n        // Skip the last bar if it is outside the graph.\n        const needToSkipLastBar = this.dataArray[0][this.dataArray[0].length - 1].date === this.dateExtent[1];\n        for (let barArray of this.dataArray) {\n            if (needToSkipLastBar) {\n                barArray = barArray.slice(0, -1);\n            }\n\n            this.svg\n                .append('g')\n                .attr('class', 'bars')\n                .selectAll(`rect.none`)\n                .data(barArray)\n                .enter()\n                .append('rect')\n                .style('fill', d => d.color)\n                .attr('x', d => this.xScale(d.date))\n                .attr('width', this.rectWidth)\n                .attr('y', d => this.yScale(d.yStart))\n                .attr('height', d => this.yScale(d.yEnd) - this.yScale(d.yStart));\n        }\n    }\n\n    _updateTooltip() {}\n}\n\nexport default CashflowBarChart;\n","import React from 'react';\nimport {\n    STARTING_CAPITAL_IDENTIFIER,\n    MONTHLY_INVESTMENT_IDENTIFIER,\n    TRANSACTION_COSTS_IDENTIFIER,\n    TRANSACTION_COSTS_TYPE_IDENTIFIER,\n    SAVING_PHASE_IDENTIFIER,\n    AGE_IDENTIFIER,\n    TAX_FREE_AMOUNT_IDENTIFIER,\n    MONTHLY_PAYOUT_IDENTIFIER,\n    LIFE_EXPECTATION_IDENTIFIER,\n    DETAILED_GRAPH_DROPDOWN_IDENTIFIER,\n} from './App';\nimport { InvestmentModel } from '../model/InvestmentModel';\nimport LineChartD3 from '../renderer/LineChartD3';\nimport CashflowBarChart from '../renderer/CashflowBarChartD3';\nimport { D3ChartStrategy } from '../renderer/D3ChartStrategy';\n\nfunction generateCostConfig(state) {\n    if (state[TRANSACTION_COSTS_TYPE_IDENTIFIER]) {\n        return { percentageCosts: 0.0, fixedCosts: state[TRANSACTION_COSTS_IDENTIFIER] };\n    } else {\n        return { percentageCosts: state[TRANSACTION_COSTS_IDENTIFIER], fixedCosts: 0.0 };\n    }\n}\n\nexport class Visualization extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.firstSVGRef = React.createRef();\n        this.secondSVGRef = React.createRef();\n    }\n\n    getInvestmentModel() {\n        const etfIdentifierToRatio = {};\n        for (const etfIdentifier in this.props.etfProperties) {\n            if (this.props.etfProperties[etfIdentifier].selected) {\n                etfIdentifierToRatio[this.props.etfProperties[etfIdentifier].symbol] = this.props.etfProperties[\n                    etfIdentifier\n                ].percentage;\n            }\n        }\n\n        return new InvestmentModel(\n            this.props[STARTING_CAPITAL_IDENTIFIER],\n            this.props[MONTHLY_INVESTMENT_IDENTIFIER],\n            this.props[MONTHLY_PAYOUT_IDENTIFIER],\n            this.props[SAVING_PHASE_IDENTIFIER],\n            etfIdentifierToRatio,\n            {\n                taxFreeAmount: this.props[TAX_FREE_AMOUNT_IDENTIFIER],\n                costConfig: generateCostConfig(this.props),\n            },\n            this.props[AGE_IDENTIFIER],\n            this.props[LIFE_EXPECTATION_IDENTIFIER]\n        );\n    }\n\n    drawVisualization() {\n        D3ChartStrategy.reset();\n        try {\n            if (this.props.isValid != null && this.props.isValid) {\n                this.investmentModel = this.getInvestmentModel();\n            }\n            const firstPayoutPhaseDate = this.investmentModel.payoutDates[0];\n            const correctLevelOfDetailInvestmentSteps = this.investmentModel.getInvestmentSteps(\n                this.props[DETAILED_GRAPH_DROPDOWN_IDENTIFIER]\n            );\n            new LineChartD3(\n                correctLevelOfDetailInvestmentSteps,\n                this.firstSVGRef.current,\n                firstPayoutPhaseDate\n            ).render();\n            new CashflowBarChart(\n                correctLevelOfDetailInvestmentSteps,\n                this.secondSVGRef.current,\n                firstPayoutPhaseDate\n            ).render();\n        } catch (e) {\n            console.error(e);\n        }\n    }\n\n    async componentDidMount() {\n        this.drawVisualization();\n    }\n\n    componentDidUpdate() {\n        this.drawVisualization();\n    }\n    render() {\n        return (\n            <React.Fragment>\n                <div ref={this.secondSVGRef}></div>\n                <div ref={this.firstSVGRef}></div>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default Visualization;\n","import React from 'react';\n\nimport { TextInputElement } from './TextInputElement';\n\nexport function SidebarSectionHeading(props) {\n    return (\n        <div className=\"position-relative\">\n            <h6 className=\"sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1\">\n                <span>{props.title}</span>\n            </h6>\n            <ErrorMessage {...props} identifier={props.title} />\n        </div>\n    );\n}\n\nexport function Overlay(props) {\n    return (\n        <div className=\"row\">\n            <div className=\"col-12 p-0\">\n                <div className=\"d-grid gap-0\">\n                    <div\n                        className=\"overlay min-vh-100 text-center m-0 d-flex flex-column justify-content-center\"\n                        style={{ visibility: props.displayOverlay ? 'visible' : 'hidden' }}>\n                        <h1 className=\"p-5\">\n                            Enter your personal{' '}\n                            <a\n                                href=\"https://www.alphavantage.co/support/#api-key\"\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\">\n                                {' '}\n                                Alphavantage API Key\n                            </a>{' '}\n                        </h1>\n                        <TextInputElement {...props} disabled={!props.displayOverlay} />\n                        <button type=\"button\" className=\"btn btn-primary my-5\" onClick={props.handleAPIKeyConfirm}>\n                            Confirm\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport function ErrorMessage(props) {\n    return (\n        <div\n            id={props.identifier + 'Feedback'}\n            className=\"invalid-tooltip\"\n            style={{ visibility: props.isValid ? 'hidden' : 'visible' }}>\n            {props.errorMessage}\n        </div>\n    );\n}\n","import React from 'react';\n\nimport { ErrorMessage } from './MinimalBootstrapComponents';\n\nexport function TextInputElement(props) {\n    return (\n        <div className=\"position-relative\">\n            <label className=\"form-label\" htmlFor={props.identifier}>\n                {props.label}\n            </label>\n            <input\n                className={'form-control ' + (props.isValid ? '' : 'is-invalid')}\n                id={props.identifier}\n                type=\"text\"\n                value={props.value.toString() + (props.textAppending !== '' ? ' ' + props.textAppending : '')}\n                onChange={e => props.onValueChange(props.transformFunction(e), props.identifier)}\n                disabled={props.disabled}\n            />\n            <ErrorMessage {...props} />\n        </div>\n    );\n}\n\nexport default TextInputElement;\n","import React from 'react';\n\nexport function CheckboxInputElement(props) {\n    return (\n        <div className=\"checkbox-element\">\n            <input\n                className=\"form-check-input\"\n                id={props.identifier}\n                type=\"checkbox\"\n                value={props.value}\n                onChange={() => props.onValueChange(props.identifier)}\n            />\n            <label className=\"form-check-label\" htmlFor={props.identifier}>\n                {props.label}\n            </label>\n        </div>\n    );\n}\n\nexport default CheckboxInputElement;\n","import React from 'react';\n\nfunction costsOfElementMatchUIValues(props, element) {\n    return element.fixedCosts === props.fixedCosts && element.percentageCosts === props.percentageCosts;\n}\n\nexport function BrokerDropDown(props) {\n    return (\n        <div className=\"dropdown\">\n            <button\n                className=\"btn btn-secondary dropdown-toggle\"\n                type=\"button\"\n                id=\"BrokerDropDown\"\n                data-bs-toggle=\"dropdown\"\n                aria-expanded=\"false\">\n                {props.label}\n            </button>\n            <ul className=\"dropdown-menu\" aria-labelledby=\"BrokerDropDown\">\n                {props.elements.map(element => (\n                    <li key={element.identifier}>\n                        <button\n                            className={\n                                costsOfElementMatchUIValues(props, element) ? 'dropdown-item active' : 'dropdown-item'\n                            }\n                            type=\"button\"\n                            onClick={e => props.handleChange(element)}>\n                            {element.label}\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n","import React from 'react';\n\nexport function GraphDetailDropDown(props) {\n    return (\n        <div className=\"dropdown\">\n            <button\n                className=\"btn btn-secondary dropdown-toggle\"\n                type=\"button\"\n                id=\"GraphDetailDropDown\"\n                data-bs-toggle=\"dropdown\"\n                aria-expanded=\"false\">\n                {props.label}\n            </button>\n            <ul className=\"dropdown-menu\" aria-labelledby=\"GraphDetailDropDown\">\n                {props.elements.map(element => (\n                    <li key={element.identifier}>\n                        <button\n                            className={\n                                props.value === element.value ? 'dropdown-item active' : 'dropdown-item'\n                            }\n                            type=\"button\"\n                            onClick={e => props.handleChange(element)}>\n                            {element.label}\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n","import React from 'react';\n\nimport { TextInputElement } from './TextInputElement';\n\nimport { ErrorMessage } from './MinimalBootstrapComponents';\n\nfunction percentageTransformFunction(e) {\n    const floatVal = parseFloat(e.target.value) / 100;\n    return isNaN(floatVal) ? 0 : floatVal;\n}\n\nexport function ETFSelectionDropDown(props) {\n    return (\n        <div className=\"dropdown position-relative\">\n            <button\n                className=\"btn btn-secondary dropdown-toggle is-invalid\"\n                type=\"button\"\n                id=\"ETFSelectionDropDown\"\n                data-bs-toggle=\"dropdown\"\n                aria-expanded=\"false\">\n                {props.label}\n            </button>\n            <ErrorMessage {...props} />\n            <ul className=\"dropdown-menu\" aria-labelledby=\"ETFSelectionDropDown\">\n                {Object.keys(props.elements).map(elementIdentifier => (\n                    <li key={elementIdentifier}>\n                        <button\n                            className={\n                                props.elements[elementIdentifier].selected ? 'dropdown-item active' : 'dropdown-item'\n                            }\n                            type=\"button\"\n                            onClick={e => {\n                                if (e.target.type !== 'text') {\n                                    props.handleSelectionChange(props.elements[elementIdentifier]);\n                                }\n                            }}>\n                            <TextInputElement\n                                {...props.elements[elementIdentifier]}\n                                value={Math.round(props.elements[elementIdentifier].percentage * 100)}\n                                textAppending=\"%\"\n                                onValueChange={props.handleShareChange}\n                                transformFunction={percentageTransformFunction}\n                                disabled={props.autoPercentage}\n                                isValid={true}\n                            />\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n}\n","import React from 'react';\n// Needed to make the drop downs work.\nimport { Dropdown, Tooltip } from 'bootstrap'; // eslint-disable-line no-unused-vars\nimport Visualization from './Visualization';\nimport TextInputElement from './TextInputElement';\nimport CheckboxInputElement from './CheckboxInputElement';\nimport { SidebarSectionHeading, Overlay } from './MinimalBootstrapComponents';\nimport { BrokerDropDown } from './BrokerDropDown';\nimport { GraphDetailDropDown } from './GraphDetailDropDown';\nimport { ETFSelectionDropDown } from './ETFSelectionDropDown';\nimport ForecastModelSingleton from '../model/ForecastModel';\n\nexport const STARTING_CAPITAL_IDENTIFIER = 'startingCapital';\nexport const MONTHLY_INVESTMENT_IDENTIFIER = 'monthlyInvestment';\nexport const TRANSACTION_COSTS_IDENTIFIER = 'transactionCosts';\nexport const TRANSACTION_COSTS_TYPE_IDENTIFIER = 'transactionCostsType';\nexport const SAVING_PHASE_IDENTIFIER = 'savingPhase';\nexport const AGE_IDENTIFIER = 'age';\nexport const TAX_FREE_AMOUNT_IDENTIFIER = 'taxFreeAmount';\nexport const MONTHLY_PAYOUT_IDENTIFIER = 'monthlyPayout';\nexport const LIFE_EXPECTATION_IDENTIFIER = 'lifeExpectation';\nexport const DETAILED_GRAPH_DROPDOWN_IDENTIFIER = 'detailedGraph';\nexport const ETF_DROPDOWN_SELECTION_IDENTIFIER = 'etfDropdownSelection';\nexport const API_KEY_IDENTIFIER = 'apiKey';\nconst BROKER_DROPDOWN_IDENTIFIER = 'brokerDropdown';\nconst ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER = 'etfAutomaticPercentage';\n\nexport const ETF_SYMBOL_TO_NAME = {\n    'SP5C.PAR': 'S & P 500',\n    'ESGE': 'iShare',\n    'SUSA': 'MSCI USA ESG',\n};\n\nfunction transformInputToInt(e) {\n    const intVal = parseInt(e.target.value.split(' ', 1));\n    return isNaN(intVal) ? 0 : intVal;\n}\n\nfunction transformInputToFloat(e) {\n    const floatVal = parseFloat(e.target.value);\n    return isNaN(floatVal) ? 0 : floatVal;\n}\n\nfunction isPercentage(val) {\n    return !Number.isNaN(val) && val >= 0 && val <= 1;\n}\n\nfunction isPositiveInt(val) {\n    return !Number.isNaN(val) && Number.isInteger(val) && val >= 0;\n}\n\nfunction constructVisualizationProps(state) {\n    const props = {};\n    for (const identifier in state) {\n        props[identifier] = state[identifier].value;\n    }\n    Object.assign(props, { etfProperties: state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements });\n    props.isValid = state.isValid;\n    return props;\n}\n\nfunction recalculateETFPercentages(state) {\n    let numberOfSelectedETFs = 0;\n    for (const etfIdentifier in state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements) {\n        if (state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[etfIdentifier].selected) {\n            numberOfSelectedETFs++;\n        }\n    }\n    const newPercentage = 1.0 / Math.max(1, numberOfSelectedETFs);\n    for (const etfIdentifier in state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements) {\n        state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[etfIdentifier].percentage = newPercentage;\n    }\n    return state;\n}\n\nexport class App extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.handleTextChange = this.handleTextChange.bind(this);\n        this.handleCheckBoxChange = this.handleCheckBoxChange.bind(this);\n        this.handleBrokerChange = this.handleBrokerChange.bind(this);\n        this.handleGraphDetailChange = this.handleGraphDetailChange.bind(this);\n        this.handleETFSelectionChange = this.handleETFSelectionChange.bind(this);\n        this.handleETFShareChange = this.handleETFShareChange.bind(this);\n        this.handleAPIKeyConfirm = this.handleAPIKeyConfirm.bind(this);\n\n        this.state = getInitialInputFormState(this);\n    }\n\n    handleTextChange(changedValue, changedStateIdentifier) {\n        const state = { ...this.state };\n        state[changedStateIdentifier].value = changedValue;\n        this.validateAndSetState(state);\n    }\n\n    handleCheckBoxChange(changedStateIdentifier) {\n        const state = { ...this.state };\n        state[changedStateIdentifier].value = !state[changedStateIdentifier].value;\n        if (changedStateIdentifier === TRANSACTION_COSTS_TYPE_IDENTIFIER) {\n            state[TRANSACTION_COSTS_IDENTIFIER].value = state[changedStateIdentifier].value ? 5 : 0.015;\n            state[TRANSACTION_COSTS_IDENTIFIER].textAppending = state[changedStateIdentifier].value ? '' : '%';\n            state[TRANSACTION_COSTS_IDENTIFIER].transformFunction = state[changedStateIdentifier].value\n                ? transformInputToInt\n                : transformInputToFloat;\n        } else if (\n            changedStateIdentifier === ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER &&\n            state[changedStateIdentifier].value\n        ) {\n            recalculateETFPercentages(state);\n        }\n        this.validateAndSetState(state);\n    }\n\n    handleBrokerChange(brokerProperties) {\n        const state = { ...this.state };\n        state[TRANSACTION_COSTS_IDENTIFIER].value =\n            brokerProperties.percentageCosts > 0 ? brokerProperties.percentageCosts : brokerProperties.fixedCosts;\n        state[TRANSACTION_COSTS_TYPE_IDENTIFIER].value = brokerProperties.percentageCosts > 0 ? false : true;\n        this.validateAndSetState(state);\n    }\n\n    handleGraphDetailChange(detailProperties) {\n        const state = { ...this.state };\n        state[DETAILED_GRAPH_DROPDOWN_IDENTIFIER].value = detailProperties.value;\n        this.validateAndSetState(state);\n    }\n\n    handleETFSelectionChange(etfProperties) {\n        const state = { ...this.state };\n        state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[etfProperties.identifier].selected = !state[\n            ETF_DROPDOWN_SELECTION_IDENTIFIER\n        ].elements[etfProperties.identifier].selected;\n        if (state[ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER].value) {\n            recalculateETFPercentages(state);\n        }\n        this.validateAndSetState(state);\n    }\n\n    handleETFShareChange(changedValue, changedETFIdentifier) {\n        const state = { ...this.state };\n        state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[changedETFIdentifier].percentage = changedValue;\n        this.validateAndSetState(state);\n    }\n\n    async handleAPIKeyConfirm() {\n        const apiKey = this.state[API_KEY_IDENTIFIER].value;\n        const apiValues = { ...this.state[API_KEY_IDENTIFIER] };\n        try {\n            await ForecastModelSingleton.loadHistoricData(\n                apiKey,\n                this.state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements\n            );\n            apiValues.error = false;\n            apiValues.displayOverlay = false;\n        } catch (e) {\n            apiValues.error = true;\n        }\n        this.setState({ [API_KEY_IDENTIFIER]: apiValues });\n        this.forceUpdate();\n    }\n\n    validateAndSetState(state) {\n        const positiveIntIdentifier = [\n            MONTHLY_INVESTMENT_IDENTIFIER,\n            MONTHLY_PAYOUT_IDENTIFIER,\n            STARTING_CAPITAL_IDENTIFIER,\n            AGE_IDENTIFIER,\n            LIFE_EXPECTATION_IDENTIFIER,\n            SAVING_PHASE_IDENTIFIER,\n            TAX_FREE_AMOUNT_IDENTIFIER,\n        ];\n        state.isValid = true;\n\n        for (const identifier of positiveIntIdentifier) {\n            state[identifier].isValid = isPositiveInt(state[identifier].value);\n            state[identifier].errorMessage = 'Please enter a positive number.';\n            state.isValid = state[identifier].isValid && state.isValid;\n        }\n\n        // Check the year values.\n        const leftoverYears = state[LIFE_EXPECTATION_IDENTIFIER].value - state[AGE_IDENTIFIER].value;\n        if (state[AGE_IDENTIFIER].value >= state[LIFE_EXPECTATION_IDENTIFIER].value) {\n            state[AGE_IDENTIFIER].errorMessage = 'You cannot be older than the life expectation';\n            state[AGE_IDENTIFIER].isValid = false;\n            state.isValid = false;\n        } else if (leftoverYears <= state[SAVING_PHASE_IDENTIFIER].value) {\n            state[SAVING_PHASE_IDENTIFIER].errorMessage =\n                'You cannot have a saving phase that lasts longer than your life.';\n            state[SAVING_PHASE_IDENTIFIER].isValid = false;\n            state.isValid = false;\n        }\n\n        // Check Cost values.\n        if (state[TRANSACTION_COSTS_TYPE_IDENTIFIER].value) {\n            state[TRANSACTION_COSTS_IDENTIFIER].isValid = isPositiveInt(state[TRANSACTION_COSTS_IDENTIFIER].value);\n            state[TRANSACTION_COSTS_IDENTIFIER].errorMessage = 'Please enter a positive number.';\n        } else {\n            state[TRANSACTION_COSTS_IDENTIFIER].isValid = isPercentage(state[TRANSACTION_COSTS_IDENTIFIER].value);\n            state[TRANSACTION_COSTS_IDENTIFIER].errorMessage = 'Please enter a valid percentage.';\n        }\n        state.isValid = state[TRANSACTION_COSTS_IDENTIFIER].isValid && state.isValid;\n\n        // Check the etf percentages.\n        let sumOfPercentages = 0;\n        let foundOneSelectedEtf = false;\n        for (const etfIdentifier in state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements) {\n            if (state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[etfIdentifier].selected) {\n                sumOfPercentages += state[ETF_DROPDOWN_SELECTION_IDENTIFIER].elements[etfIdentifier].percentage;\n                foundOneSelectedEtf = true;\n            }\n        }\n        if (!foundOneSelectedEtf) {\n            state[ETF_DROPDOWN_SELECTION_IDENTIFIER].isValid = false;\n            state[ETF_DROPDOWN_SELECTION_IDENTIFIER].errorMessage = 'Please select at least one ETF.';\n            state.isValid = false;\n        } else if (sumOfPercentages !== 1.0) {\n            state[ETF_DROPDOWN_SELECTION_IDENTIFIER].isValid = false;\n            state[ETF_DROPDOWN_SELECTION_IDENTIFIER].errorMessage = 'The sum of all selected ETF needs to be 100%';\n            state.isValid = false;\n        } else {\n            state[ETF_DROPDOWN_SELECTION_IDENTIFIER].isValid = true;\n        }\n\n        this.setState(state);\n    }\n\n    render() {\n        const visualizationProps = constructVisualizationProps(this.state);\n        return (\n            <div className=\"container-fluid\">\n                <Overlay {...this.state[API_KEY_IDENTIFIER]} />\n                <div className=\"row\">\n                    <nav id=\"sidebarMenu\" className=\"col-md-3 col-lg-2 bg-light sidebar\">\n                        <form className=\"position-sticky needs-validation\" noValidate>\n                            {/* Money Options */}\n                            <SidebarSectionHeading title=\"Money Options\" />\n                            <TextInputElement\n                                key={STARTING_CAPITAL_IDENTIFIER}\n                                {...this.state[STARTING_CAPITAL_IDENTIFIER]}\n                            />\n                            <TextInputElement\n                                key={MONTHLY_INVESTMENT_IDENTIFIER}\n                                {...this.state[MONTHLY_INVESTMENT_IDENTIFIER]}\n                            />\n                            <TextInputElement\n                                key={MONTHLY_PAYOUT_IDENTIFIER}\n                                {...this.state[MONTHLY_PAYOUT_IDENTIFIER]}\n                            />\n                            <TextInputElement\n                                key={TAX_FREE_AMOUNT_IDENTIFIER}\n                                {...this.state[TAX_FREE_AMOUNT_IDENTIFIER]}\n                            />\n                            {/* Time Options */}\n                            <SidebarSectionHeading title=\"Time Options\" />\n                            <TextInputElement key={AGE_IDENTIFIER} {...this.state[AGE_IDENTIFIER]} />\n                            <TextInputElement\n                                key={LIFE_EXPECTATION_IDENTIFIER}\n                                {...this.state[LIFE_EXPECTATION_IDENTIFIER]}\n                            />\n                            <TextInputElement key={SAVING_PHASE_IDENTIFIER} {...this.state[SAVING_PHASE_IDENTIFIER]} />\n                            {/* Cost Options */}\n                            <SidebarSectionHeading title=\"Cost Options\" />\n                            <TextInputElement\n                                key={TRANSACTION_COSTS_IDENTIFIER}\n                                {...this.state[TRANSACTION_COSTS_IDENTIFIER]}\n                            />\n                            <CheckboxInputElement\n                                key={TRANSACTION_COSTS_TYPE_IDENTIFIER}\n                                {...this.state[TRANSACTION_COSTS_TYPE_IDENTIFIER]}\n                            />\n                            <BrokerDropDown\n                                key={BROKER_DROPDOWN_IDENTIFIER}\n                                fixedCosts={\n                                    this.state[TRANSACTION_COSTS_TYPE_IDENTIFIER].value\n                                        ? this.state[TRANSACTION_COSTS_IDENTIFIER].value\n                                        : 0\n                                }\n                                percentageCosts={\n                                    this.state[TRANSACTION_COSTS_TYPE_IDENTIFIER].value\n                                        ? 0\n                                        : this.state[TRANSACTION_COSTS_IDENTIFIER].value\n                                }\n                                {...this.state[BROKER_DROPDOWN_IDENTIFIER]}\n                            />\n                            {/* Visualization Options */}\n                            <SidebarSectionHeading title=\"Visualization Options\" />\n                            <div className=\"d-grid gap-0\">\n                                <div className=\"p-1\">\n                                    <GraphDetailDropDown\n                                        key={DETAILED_GRAPH_DROPDOWN_IDENTIFIER}\n                                        {...this.state[DETAILED_GRAPH_DROPDOWN_IDENTIFIER]}\n                                    />\n                                </div>\n                                <CheckboxInputElement\n                                    key={ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER}\n                                    {...this.state[ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER]}\n                                />\n                                <div className=\"p-1\">\n                                    <ETFSelectionDropDown\n                                        key={ETF_DROPDOWN_SELECTION_IDENTIFIER}\n                                        autoPercentage={this.state[ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER].value}\n                                        {...this.state[ETF_DROPDOWN_SELECTION_IDENTIFIER]}\n                                    />\n                                </div>\n                            </div>\n                        </form>\n                    </nav>\n                    <main className=\"col-md-9 col-lg-10 ms-sm-auto\">\n                        <h1>Etf Pension Plan Visualization</h1>\n                        <Visualization {...visualizationProps} />\n                    </main>\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction getInitialInputFormState(caller) {\n    return {\n        isValid: true,\n        // simple ui elements.\n        [STARTING_CAPITAL_IDENTIFIER]: {\n            value: 1000,\n            label: 'Starting Capital',\n            errorMessage: '',\n            textAppending: '',\n            isValid: true,\n            identifier: STARTING_CAPITAL_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [MONTHLY_INVESTMENT_IDENTIFIER]: {\n            value: 100,\n            label: 'Monthly Investment',\n            errorMessage: 'Please enter a positive Money amount.',\n            textAppending: '',\n            isValid: true,\n            identifier: MONTHLY_INVESTMENT_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [MONTHLY_PAYOUT_IDENTIFIER]: {\n            value: 1000,\n            label: 'Monthly Payout',\n            errorMessage: '',\n            textAppending: '',\n            isValid: true,\n            identifier: MONTHLY_PAYOUT_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [TRANSACTION_COSTS_IDENTIFIER]: {\n            value: 0.015,\n            label: 'Transaction Costs',\n            errorMessage: '',\n            textAppending: '%',\n            isValid: true,\n            identifier: TRANSACTION_COSTS_IDENTIFIER,\n            transformFunction: transformInputToFloat,\n            onValueChange: caller.handleTextChange,\n        },\n        [TRANSACTION_COSTS_TYPE_IDENTIFIER]: {\n            value: false,\n            label: 'Fixed Amount',\n            identifier: TRANSACTION_COSTS_TYPE_IDENTIFIER,\n            onValueChange: caller.handleCheckBoxChange,\n        },\n        [SAVING_PHASE_IDENTIFIER]: {\n            value: 40,\n            label: 'Saving Phase',\n            errorMessage: '',\n            textAppending: 'Y',\n            isValid: true,\n            identifier: SAVING_PHASE_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [AGE_IDENTIFIER]: {\n            value: 30,\n            label: 'Your Age',\n            textAppending: 'Y',\n            errorMessage: '',\n            isValid: true,\n            identifier: AGE_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [LIFE_EXPECTATION_IDENTIFIER]: {\n            value: 80,\n            label: 'Life Expectation',\n            errorMessage: '',\n            isValid: true,\n            textAppending: 'Y',\n            identifier: LIFE_EXPECTATION_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [TAX_FREE_AMOUNT_IDENTIFIER]: {\n            value: 801,\n            label: 'Tax Free Amount',\n            errorMessage: '',\n            isValid: true,\n            textAppending: '',\n            identifier: TAX_FREE_AMOUNT_IDENTIFIER,\n            transformFunction: transformInputToInt,\n            onValueChange: caller.handleTextChange,\n        },\n        [ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER]: {\n            value: false,\n            label: 'Automatic ETF Ratio',\n            identifier: ETF_AUTOMATIC_PERCENTAGE_IDENTIFIER,\n            onValueChange: caller.handleCheckBoxChange,\n        },\n        [API_KEY_IDENTIFIER]: {\n            displayOverlay: true,\n            value: '',\n            label: '',\n            errorMessage: '',\n            isValid: true,\n            textAppending: '',\n            identifier: API_KEY_IDENTIFIER,\n            transformFunction: e => e.target.value,\n            onValueChange: caller.handleTextChange,\n            handleAPIKeyConfirm: caller.handleAPIKeyConfirm,\n        },\n        // Complex UI elements.\n        [DETAILED_GRAPH_DROPDOWN_IDENTIFIER]: {\n            value: 1,\n            label: 'Graph Detail Level',\n            isValid: true,\n            handleChange: caller.handleGraphDetailChange,\n            elements: [\n                {\n                    identifier: '12',\n                    value: 12,\n                    label: 'All Months a Year (highest detail)',\n                },\n                {\n                    identifier: '6',\n                    value: 6,\n                    label: 'Every 2nd Month (higher detail)',\n                },\n                {\n                    identifier: '3',\n                    value: 3,\n                    label: 'Every 4th Month (lower detail)',\n                },\n                {\n                    identifier: '1',\n                    value: 1,\n                    label: 'One Month a Year (lowest detail) (default)',\n                },\n            ],\n        },\n        [BROKER_DROPDOWN_IDENTIFIER]: {\n            label: 'Broker',\n            isValid: true,\n            handleChange: caller.handleBrokerChange,\n            elements: [\n                {\n                    identifier: 'comdirect',\n                    label: 'comdirect',\n                    fixedCosts: 0,\n                    percentageCosts: 0.015,\n                },\n                {\n                    identifier: 'tradeRepublic',\n                    label: 'Trade Republic',\n                    fixedCosts: 0,\n                    percentageCosts: 0.01,\n                },\n                {\n                    identifier: 'eToro',\n                    label: 'eToro',\n                    fixedCosts: 0,\n                    percentageCosts: 0.0,\n                },\n            ],\n        },\n        [ETF_DROPDOWN_SELECTION_IDENTIFIER]: {\n            label: 'ETF Selection',\n            isValid: true,\n            identifier: ETF_DROPDOWN_SELECTION_IDENTIFIER,\n            errorMessage: '',\n            handleSelectionChange: caller.handleETFSelectionChange,\n            handleShareChange: caller.handleETFShareChange,\n            elements: {\n                S_and_P_500: {\n                    identifier: 'S_and_P_500',\n                    symbol: 'SP5C.PAR',\n                    label: ETF_SYMBOL_TO_NAME['SP5C.PAR'],\n                    percentage: 1.0,\n                    selected: true,\n                },\n                iShare: {\n                    identifier: 'iShare',\n                    symbol: 'ESGE',\n                    label: ETF_SYMBOL_TO_NAME['ESGE'],\n                    percentage: 1.0,\n                    selected: false,\n                },\n                msciUSA: {\n                    identifier: 'msciUSA',\n                    symbol: 'SUSA',\n                    label: ETF_SYMBOL_TO_NAME['SUSA'],\n                    percentage: 1.0,\n                    selected: false,\n                },\n            },\n        },\n    };\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './scss/main.scss';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}